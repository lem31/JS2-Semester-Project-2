import{h as te,d as ae}from"./headers-DqursC6B.js";import{f as oe,i as Q,b as ce,d as le,t as ie,s as re,e as me}from"./read-BNWd3mxs.js";import{d as pe}from"./edit-C3rJwrlT.js";import{p as Ee}from"./place-BSjMR1GP.js";import{d as ue,o as Le}from"./notFound-CbPKQgZ2.js";async function Ce(e){try{const n=await fetch(`https://v2.api.noroff.dev/auction/listings/${e}`,{method:"DELETE",headers:te()});if(n.ok){const t=document.createElement("div");t.innerHTML="Post deleted successfully <br> Please Wait...",t.style.color="green",t.classList.add("text-red-500","bg-black","absolute","text-3xl","left-1/2","top-1/2","transform","-translate-x-1/2","-translate-y-1/2","z-50"),document.body.appendChild(t),setTimeout(()=>{window.location.href="/my_listings/"},3e3)}else{const t=await n.json();throw new Error(t.message||"Failed to delete post")}}catch(n){const t=document.createElement("div");t.textContent=n.message,t.style.color="red",document.body.appendChild(t)}}function be(e){const n=e.target.dataset.id;Ce(n)}function Ie(e){const n=document.createElement("div"),t=document.createElement("div");t.id="image-container";const s=document.createElement("form"),m=document.createElement("div"),l=document.createElement("h2"),i=document.createElement("input"),T=document.createElement("label"),N=document.createElement("img"),D=document.createElement("div"),p=document.createElement("button"),L=document.createElement("button"),w=document.createElement("div"),A=document.createElement("div"),f=document.createElement("div"),C=document.createElement("div"),E=document.createElement("button"),r=document.createElement("button");E.addEventListener("click",o=>{pe(o)}),r.addEventListener("click",be),r.dataset.id=e.id,E.dataset.id=e.id;const S=document.createElement("img");N.src="/images/icons8-coins-64.png",S.src="/images/icons8-coins-64.png",s.style.display="none",i.placeholder="Enter bid amount",i.classList.add("place-bid-input"),L.textContent="Place bid",L.type="submit",p.textContent="X",p.type="button",l.textContent="Place Bid",T.textContent="Your bid",A.appendChild(L),D.appendChild(p),s.appendChild(D),m.appendChild(l),s.appendChild(m),f.appendChild(T),s.appendChild(f),s.appendChild(C),C.appendChild(S),C.appendChild(i),s.appendChild(A),w.appendChild(s),oe(e,t);const x=document.createElement("p"),g=document.createElement("img"),b=document.createElement("div"),O=document.createElement("h2"),P=document.createElement("p"),M=document.createElement("p"),v=document.createElement("p"),I=document.createElement("div"),G=document.createElement("button"),h=document.createElement("button"),a=document.createElement("div"),c=document.createElement("div"),_=document.createElement("p"),F=document.createElement("p"),V=document.createElement("img"),H=document.createElement("p"),U=document.createElement("div"),k=document.createElement("div"),Y=document.createElement("div"),Z=document.getElementById("my-auction-listings"),y=document.createElement("button"),B=document.createElement("button"),q=document.createElement("img"),W=document.createElement("img"),$=document.createElement("div");q.src="/images/icons8-left-100.png",W.src="/images/icons8-right-100.png";const z=document.createElement("div");G.addEventListener("click",()=>{if(!Q()){alert("You need to be logged in to place a bid.");return}s.style.display==="none"?s.style.display="block":s.style.display="none"}),s.addEventListener("submit",o=>{o.preventDefault();const d=s.querySelector(".place-bid-input").value;Ee(e.id,d,o)}),h.textContent="View Bids",x.textContent=`Seller: ${e.seller.name}`,g.src=e.seller&&e.seller.avatar?e.seller.avatar.url:"",E.textContent="Edit",Q()&&e._count&&e._count.bids!==void 0&&(_.textContent=`No. of bids: ${e._count.bids}`),F.textContent=e.bids&&e.bids.length>0?`Bidder: ${e.bids[0].bidder.name}`:"No bidders",V.src=e.bids&&e.bids.length>0?e.bids[0].bidder.avatar.url:"",H.textContent=e.bids&&e.bids.length>0?`Bid amount: ${e.bids[0].amount}`:"No bids",r.textContent="Delete",O.textContent=e.title||"No title available",P.textContent=e.description||"No description available";const ee=new Date(e.endsAt),ne={weekday:"long",year:"numeric",month:"long",day:"numeric"},se=ee.toLocaleDateString("en-US",ne),de=ee.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});v.textContent=`Ends At: ${de} on ${se}`||"No end date available",B.appendChild(W),y.appendChild(q),new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e.title)||a.appendChild(O),a.appendChild($),$.appendChild(N),$.appendChild(_),a.appendChild(P),a.appendChild(M),a.appendChild(v),a.appendChild(b),U.appendChild(h),I.appendChild(E),I.appendChild(r),a.appendChild(I),a.appendChild(U),a.appendChild(c),Y.appendChild(t),k.appendChild(Y),b.appendChild(g),b.appendChild(x),t.appendChild(y),t.appendChild(B),n.appendChild(k),n.appendChild(t),n.appendChild(a),n.appendChild(s),z.appendChild(n),ce(z),e.bids&&e.bids.length>0&&e.bids.forEach(o=>{const d=document.createElement("div"),u=document.createElement("div"),X=document.createElement("div"),j=document.createElement("p"),J=document.createElement("img"),K=document.createElement("p");j.textContent=`Bidder: ${o.bidder.name}`,J.src=o.bidder.avatar.url||"",K.textContent=`Bid amount: ${o.amount}`;const R=document.createElement("img");R.src="/images/icons8-coins-64.png",R.alt="Coin icon",R.classList.add("coin-icon"),u.appendChild(J),u.appendChild(j),d.appendChild(u),X.appendChild(R),X.appendChild(K),d.appendChild(X),c.appendChild(d),j.classList.add("labels"),u.classList.add("flex-row-center"),K.classList.add("labels"),J.classList.add("seller-avatar-img"),R.classList.add("w-[30px]","h-[30px]","md:w-[50px]","md:h-[50px]"),X.classList.add("flex-row-center")}),Z.appendChild(z),h.addEventListener("click",()=>{if(!Q()){alert("You need to be logged in to view bids.");return}const o=document.querySelector(".view-bids-box");if(o&&o!==c){const d=document.createElement("p");d.textContent="Please close the current bids before opening another.",d.classList.add("error-message","no-bids-message","absolute","left-1/2","top-1/2","transform","-translate-x-1/2","-translate-y-1/2","bg-white","text-red-500","z-50","text-xl"),n.appendChild(d);const u=event.target.getBoundingClientRect();d.style.top=`${u.top+window.scrollY}px`,d.style.left=`${u.left+window.scrollX}px`,setTimeout(()=>{d.remove()},3e3);return}if(e.bids&&e.bids.length>0)c.classList.contains("hidden")||!c.classList.contains("view-bids-box")?(c.classList.remove("hidden"),c.classList.add("view-bids-box")):(c.classList.add("hidden"),c.classList.remove("view-bids-box"));else{const d=document.createElement("p");d.textContent="No bids available.",d.classList.add("no-bids-message","bg-white","text-red-500","absolute","text-xl","z-50"),n.appendChild(d),setTimeout(()=>{d.remove()},3e3)}}),he(x,O,_,v,M,G,z,n,t,Y,s,i,L,p,y,B,a,h,g,c,b,$,Z,N,l,T,w,m,A,f,C,I,q,W,S,r,E),p.addEventListener("click",o=>le(o,s)),ie(t,y,B),re(n,y,B,t.querySelectorAll(".carouselItem"))}function he(e,n,t,s,m,l,i,T,N,D,p,L,w,A,f,C,E,r,S,x,g,b,O,P,M,v,I,G,h,a,c,_,F,V,H,U,k){e.classList.add("labels"),n.classList.add("h2-styles"),t.classList.add("labels"),s.classList.add("labels","max-w-[150px]","mb-2"),m.classList.add("h2-styles"),l.classList.add("display-place-bid-form-btn"),i.classList.add("inner-container-styles"),N.classList.add("image-container","imageContainer"),D.classList.add("carouselInner","carousel-inner"),T.classList.add("listing-container-styles","listing-box"),p.classList.add("place-bid-form","form-styles","w-[280px]","h-[218px]","absolute"),A.classList.add("close-btn","button-styles","pl-2","pr-2","p-t-1","p-b-1"),M.classList.add("h2-styles","form-title-styles"),f.classList.add("carousel-control-left"),C.classList.add("carousel-control-right"),E.classList.add("flex-col-center-layout"),r.classList.add("view-bids-btn","button-styles","pl-3","pr-3","pt-1","pb-1"),S.classList.add("seller-avatar-img"),l.classList.add("display-place-bid-form-btn","button-styles","pl-3","pr-3","pt-1","pb-1"),r.classList.add("button-styles","view-listing-btn","pl-3","pr-3","pt-1","pb-1","mb-2"),x.classList.add("hidden"),g.classList.add("flex-row-center"),b.classList.add("flex-row-center"),O.classList.add("outer-container"),P.classList.add("w-[30px]","h-[30px]","md:w-[50px]","md:h-[50px]"),H.classList.add("w-[30px]","h-[30px]","md:w-[50px]","md:h-[50px]"),v.classList.add("gold-labels","ml-8"),w.classList.add("place-bid-submit","button-styles","mt-4","pl-3","pr-3","pt-1","pb-1"),I.classList.add("relative"),G.classList.add("flex-row-center","mb-4","text-center","mt-[-18px]"),h.classList.add("flex-row-center"),a.classList.add("flex","flex-col"),L.classList.add("place-bid-input","input-styles"),c.classList.add("flex-row-center"),_.classList.add("flex-row-center","gap-4","mt-3","mb-3"),me(F,V),_.classList.add("flex-row-center","gap-4","mt-3","mb-3"),U.classList.add("delete-btn","button-styles","pl-3","pr-3","pt-1","pb-1"),k.classList.add("edit-btn","button-styles","pl-3","pr-3","pt-1","pb-1")}async function _e(){try{if(!localStorage.getItem("accessToken"))throw new Error("No access token found. Please log in.");const n=await fetch(ae,{method:"GET",headers:te()});if(!n.ok)throw new Error(`HTTP error! status: ${n.status||"unknown"}`);const s=(await n.json()).data||[];localStorage.setItem("myListings",JSON.stringify(s));const m=JSON.parse(localStorage.getItem("myListings")||"[]"),l=document.getElementById("my-auction-listings");l&&m.forEach(i=>{Ie(i,l)})}catch{throw new Error("Error fetching listings")}}_e();ue();Le();
